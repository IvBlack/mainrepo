#Как работает система:
Когда юзер нажмает кнопку Купить (интеренет-магазин с корзиной и тд.), мы должны как-то обработать заказ, сохранить его, сохранить товары, которые привязаны к заказу и получить номер заказа (либо уникальный номер, строку), который будет явно идентифицировать заказ. После этого отправляем пользователя на страницу оплаты. Делается след.образом: запоминаем нужные данные в сессию, отправляем на страницу оплаты (форма в нашем случае, которую сгенерировала Интеркасса либо же это может быть форма кошелька типа WebMoney), куда мы подставляем ID кассы/кошелька
<input type="hidden" name="ik_co_id" value="51237daa8f2a2d8413000000"/>
далее - ID заказа, сумму, валюту, описание + кнопка Оплатить
<input type="hidden" name="ik_pm_no" value="ID_4233"/>
  <input type="hidden" name="ik_am" value="1.44"/>
  <input type="hidden" name="ik_cur" value="uah"/>
  <input type="hidden" name="ik_desc" value="Payment Description"/>
  <input type="submit" value="Pay">
  
далее делается задержка отправки формы /предотвращение хищения страницы/.
Платежная система, произведя оплату, отправляет нам ответ, который мы принимаем по адресу /process.php/, где мы формируем нужные нам переменные /ключ, id кассы, и из POST наши данные/ 
$key = 'uc18larViw9UYbsa';
$ik_id = '51237daa8f2a2d8413000000';
$dataSet = $_POST;
Далее мы сформируем подпись:
unset($dataSet['ik_sign']); //удаляется значение
ksort($dataSet, SORT_STRING); 
array_push($dataSet, $key); //выбирается ключ $key
$signString = implode(':', $dataSet); //формируется строка с разделителем
$sign = base64_encode(md5($signString, true)); //кодируется
Получаем данные заказа
$order = R::load('orders', (int)$dataSet['ik_pm_no']);
if(!$order){
    die;
    
Делаем необходимые проверки
если статус платежа не совпадает
или сумма не соответствует заявленной
или номер кассы
или если подпись не соответствует той, которую мы сформировали, то в этом случае мы прекращаем работу.
Если все ок, то меняем статус заказа на оплаченный и заносим все это в базу:
$order->status = '1';
//сохраняем состояние объекта в БД
R::store($order);
